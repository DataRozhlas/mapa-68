<!DOCTYPE html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no" />

<!--embed-->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.3/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.3.3/dist/leaflet.js"></script>
<script src="http://data.irozhlas.cz/mapa-68/map_data.js"></script>

<style>
    #map {
        height: 400px;
    }
    #legend {
        height: auto;
        width: 100%;
        margin: 10px 0px 10px 0px;
    }
</style>

<div id="map"></div>
<div id="legend">
    Vyberte událost na mapě.
</div>

<script>
    var map = L.map('map').setView([50.0835494, 14.4341414], 7);

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> přispěvatelé',
        maxZoom: 18,
    }).addTo(map);

    var markers = [];
    data.forEach(function(d) {
        var pnt = L.circleMarker([parseFloat(d.Lokace.split(', ')[0]), parseFloat(d.Lokace.split(', ')[1])], {
            color: '#3182bd',
            weight: 1,
            fillColor: '#3182bd',
            fillOpacity: 0.5,
            radius: 7,
            titulek: d.Titulek,
            popis: d.Popis,
            url: d.Link
        }).addTo(map);

        markers.push(pnt)

        pnt.on('click', function(evt){
            var ops = evt.target.options
            document.getElementById('legend').innerHTML = '<b>' + ops.titulek + '</b><br>' + ops.popis 
            + '<br><a target="_blank" rel="noopener noreferrer" href="'+ ops.url + '">čtěte více</a>'
        });
    });

    var markerGroup = new L.featureGroup(markers);
    map.fitBounds(markerGroup.getBounds());
</script>